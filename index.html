<script>
// Funktion för att säkerställa att URL:en har https:// i början
function fixURL(url){
    url = url.trim();
    if(!/^https?:\/\//i.test(url)) return 'https://' + url;
    return url;
}

// Funktion för att öppna sökresultat i ett nytt fönster/flik
function searchInNewTab(query){
    const q = encodeURIComponent(query);
    const searchUrl = 'https://www.bing.com/search?q=' + q;
    window.open(searchUrl, '_blank');
}

// NY FUNKTION: Försöker ladda URL:en via Google Translate som en proxy
function loadViaProxy(targetUrl) {
    const encodedTarget = encodeURIComponent(targetUrl);
    // Använd Google Translate som proxy för att försöka kringgå iFrame-begränsningar
    const proxyUrl = 'https://translate.google.com/translate?sl=auto&tl=sv&u=' + encodedTarget;
    document.getElementById('contentFrame').src = proxyUrl;
}

// Huvudnavigeringsfunktion, anropas av "Go" och Enter
function navigate(){
    const raw = document.getElementById('urlInput').value.trim();
    if(!raw) return;
    
    // Logik: Om sökterm (innehåller mellanslag eller saknar punkt och är kort)
    if(/\s/.test(raw) || (!raw.includes('.') && raw.length > 0 && raw.length < 20)){
        searchInNewTab(raw); // Öppna sökning i nytt fönster
        return; 
    } else {
        // Om URL (t.ex. google.com), försök ladda den via proxyn
        const urlToProxy = fixURL(raw);
        loadViaProxy(urlToProxy);
    }
}

// Anropas när "Sök"-knappen klickas.
function search(){
    const raw = document.getElementById('urlInput').value.trim();
    if(!raw) return;
    searchInNewTab(raw); // Använder alltid nytt fönster för sökning
}

// Anropas från exempelknapparna
function openTest(v){
    document.getElementById('urlInput').value = v;
    navigate();
}

// Hantera Enter-tryck i input-fältet
document.getElementById('urlInput').addEventListener('keypress', function(e){
    if(e.key === 'Enter'){
        navigate();
    }
});
</script>
